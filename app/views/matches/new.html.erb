<div class="container py-4">
  <div class="card">
    <div class="card-header bg-primary text-white">
      <h1 class="mb-0">
        <i class="bi bi-calendar-plus"></i> Cadastrar Nova Partida
      </h1>
    </div>
    
    <div class="card-body">
      <%= form_with(model: @match, html: { class: "needs-validation", novalidate: true, id: "match-form" }) do |form| %>
        <% if @match.errors.any? %>
          <div class="alert alert-danger alert-dismissible fade show">
            <h5 class="alert-heading">Corrija os seguintes erros:</h5>
            <ul class="mb-0">
              <% @match.errors.full_messages.each do |message| %>
                <li><%= message %></li>
              <% end %>
            </ul>
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
          </div>
        <% end %>

        <!-- Seção Campeonato -->
        <div class="mb-4 border-bottom pb-3">
          <div class="d-flex justify-content-between align-items-center mb-3">
            <h5 class="fw-bold text-primary">
              <i class="bi bi-trophy"></i> Informações do Campeonato
            </h5>
            <%= link_to new_admin_championship_path, class: "btn btn-sm btn-outline-primary" do %>
              <i class="bi bi-plus-lg"></i> Novo Campeonato
            <% end %>
          </div>

          <% if @championships.empty? %>
            <div class="alert alert-warning mb-3">
              Nenhum campeonato disponível. <%= link_to "Clique aqui para criar um.", new_admin_championship_path %>
            </div>
          <% else %>
            <div class="mb-3">
              <%= form.label :championship_id, "Campeonato", class: "form-label fw-bold" %>
              <%= form.collection_select :championship_id, @championships, :id, :name, 
                    { prompt: "Selecione o campeonato..." }, 
                    { class: "form-select select2", required: true } %>
              <div class="invalid-feedback">
                Por favor, selecione um campeonato.
              </div>
            </div>
          <% end %>
        </div>

        <!-- Seção Times -->
        <div class="mb-4 border-bottom pb-3">
          <h5 class="fw-bold text-primary mb-3">
            <i class="bi bi-people-fill"></i> Informações dos Times
          </h5>

          <% teams_list = ["ATLÉTICO-MG","ATLÉTICO-PR","BAHIA-BA","BOTAFOGO-RJ","CORINTHIANS-SP","CORITIBA-PR","CRICIÚMA-SC","CRUZEIRO-MG","FLAMENGO-RJ","FLUMINENSE-RJ","GOIÁS-GO","GRÊMIO-RS","INTERNACIONAL-RS","NÁUTICO-PE","PONTE PRETA-SP","PORTUGUESA-SP","SANTOS-SP","SÃO PAULO-SP","VASCO DA GAMA-RJ","VITÓRIA-BA","ABC-RN","AMÉRICA-MG","AMÉRICA-RN","ASA-AL","ATLÉTICO-GO","AVAÍ-SC","BOA-MG","BRAGANTINO-SP","CEARÁ-CE","CHAPECOENSE-SC","FIGUEIRENSE-SC","GUARATINGUETÁ-SP","ICASA-CE","JOINVILLE-SC","OESTE-SP","PALMEIRAS-SP","PARANÁ-PR","PAYSANDU-PA","SÃO CAETANO-SP","SPORT-PE","ÁGUIA DE MARABÁ-PA","BARAÚNAS-RN","BETIM-MG","BRASILIENSE-DF","CAXIAS-RS","CRAC-GO","CRB-AL","CUIABÁ-MT","DUQUE DE CAXIAS-RJ","FORTALEZA-CE","GRÊMIO BARUERI-SP","GUARANI-SP","LUVERDENSE-MT","MACAÉ-RJ","MADUREIRA-RJ","MOGI MIRIM-SP","SAMPAIO CORRÊA-MA","SANTA CRUZ-PE","VILA NOVA-GO","TREZE-PB","NACIONAL-AM","PARAGOMINAS","PLÁCIDO DE CASTRO","VILHENA","NÁUTICO-RR","SALGUEIRO","GURUPI","YPIRANGA-AP","MARANHÃO","PARNAHYBA","TIRADENTES","GUARANY DE SOBRAL","YPIRANGA-PE","POTIGUAR DE MOSSORÓ","CENTRAL","SERGIPE","BOTAFOGO-PB","CSA","JUAZEIRENSE","VITÓRIA DA CONQUISTA","GOIANÉSIA","MIXTO","BRASÍLIA","APARECIDENSE","ÁGUIA NEGRA","TUPI-MG","NOVA IGUAÇU","RESENDE","ARAXÁ","ARACRUZ","JUVENTUDE","MARCÍLIO DIAS","SANTO ANDRÉ","VILLA NOVA-MG","PENAPOLENSE","METROPOLITANO-SC","JMALUCELLI","LAJEADENSE","LONDRINA","BOTAFOGO-SP"] %>

          <div class="row">
            <div class="col-md-6">
              <div class="mb-3">
                <%= form.label :team_a, "Time A", class: "form-label fw-bold" %>
                <%= form.select :team_a, teams_list, { prompt: "Selecione o Time A..." }, { class: "form-select select2", required: true } %>
                <div class="invalid-feedback">
                  Por favor, selecione o Time A.
                </div>
              </div>
            </div>

            <div class="col-md-6">
              <div class="mb-3">
                <%= form.label :team_b, "Time B", class: "form-label fw-bold" %>
                <%= form.select :team_b, teams_list, { prompt: "Selecione o Time B..." }, { class: "form-select select2", required: true } %>
                <div class="invalid-feedback">
                  Por favor, selecione o Time B.
                </div>
              </div>
            </div>
          </div>

          <div class="row">
            <div class="col-md-6">
              <div class="mb-3">
                <%= form.label :team_a_logo, "Escudo Time A", class: "form-label fw-bold" %>
                <%= form.file_field :team_a_logo, class: "form-control", accept: "image/*" %>
                <small class="form-text text-muted">Formatos: JPG, PNG (max 2MB)</small>
              </div>
            </div>

            <div class="col-md-6">
              <div class="mb-3">
                <%= form.label :team_b_logo, "Escudo Time B", class: "form-label fw-bold" %>
                <%= form.file_field :team_b_logo, class: "form-control", accept: "image/*" %>
                <small class="form-text text-muted">Formatos: JPG, PNG (max 2MB)</small>
              </div>
            </div>
          </div>
        </div>

        <!-- Seção Data e Local -->
        <div class="mb-4 border-bottom pb-3">
          <h5 class="fw-bold text-primary mb-3">
            <i class="bi bi-calendar-event"></i> Data e Local
          </h5>

          <div class="row">
            <div class="col-md-6">
              <div class="mb-3">
                <%= form.label :match_date, "Data e Hora", class: "form-label fw-bold" %>
                <%= form.datetime_local_field :match_date, class: "form-control", required: true,
                      id: "match-date-field" %>
                <div class="invalid-feedback">
                  Por favor, informe uma data/hora futura válida.
                </div>
              </div>
            </div>
            
            <div class="col-md-6">
              <div class="mb-3">
                <%= form.label :location, "Local", class: "form-label fw-bold" %>
                <%= form.text_field :location, class: "form-control",
                      placeholder: "Estádio ou Local da Partida" %>
              </div>
            </div>
          </div>
        </div>

        <!-- Seção Observações -->
        <div class="mb-4">
          <div class="mb-3">
            <%= form.label :notes, "Observações", class: "form-label fw-bold" %>
            <%= form.text_area :notes, class: "form-control", rows: 3,
                  placeholder: "Informações adicionais sobre a partida..." %>
          </div>
        </div>

        <!-- Botões de Ação -->
        <div class="d-grid gap-2 d-md-flex justify-content-md-end mt-4">
          <%= link_to matches_path, class: "btn btn-secondary me-md-2" do %>
            <i class="bi bi-arrow-left"></i> Voltar
          <% end %>
          <button type="submit" class="btn btn-primary">
            <i class="bi bi-save"></i> Salvar Partida
          </button>
        </div>
      <% end %>
    </div>
  </div>
</div>

<!-- Modal de Confirmação -->
<div class="modal fade" id="confirmationModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Confirmar Dados</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <p>Confirma os dados da partida?</p>
        <div id="match-summary"></div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Corrigir</button>
        <button type="button" class="btn btn-primary" id="confirm-submit">Confirmar</button>
      </div>
    </div>
  </div>
</div>

<%= javascript_include_tag 'matches_form' %>

<style>
  .select2-container--default .select2-selection--single {
    height: 38px;
    padding: 5px;
    border: 1px solid #ced4da;
    border-radius: 0.375rem;
  }
  
  .card-header {
    border-bottom: 2px solid rgba(0,0,0,.125);
  }
  
  .form-label.required:after {
    content: " *";
    color: #dc3545;
  }
</style>